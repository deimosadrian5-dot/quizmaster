<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>All Quizzes â€” QuizMaster</title>
    <script>
        var THEMES={indigo:{label:'Indigo',primary:'#4f46e5',secondary:'#7c3aed',rgb:'99,102,241',palette:{50:'#eef2ff',100:'#e0e7ff',200:'#c7d2fe',300:'#a5b4fc',400:'#818cf8',500:'#6366f1',600:'#4f46e5',700:'#4338ca',800:'#3730a3',900:'#312e81'}},ocean:{label:'Ocean',primary:'#0284c7',secondary:'#06b6d4',rgb:'2,132,199',palette:{50:'#f0f9ff',100:'#e0f2fe',200:'#bae6fd',300:'#7dd3fc',400:'#38bdf8',500:'#0ea5e9',600:'#0284c7',700:'#0369a1',800:'#075985',900:'#0c4a6e'}},emerald:{label:'Emerald',primary:'#059669',secondary:'#10b981',rgb:'5,150,105',palette:{50:'#ecfdf5',100:'#d1fae5',200:'#a7f3d0',300:'#6ee7b7',400:'#34d399',500:'#10b981',600:'#059669',700:'#047857',800:'#065f46',900:'#064e3b'}},sunset:{label:'Sunset',primary:'#ea580c',secondary:'#f59e0b',rgb:'234,88,12',palette:{50:'#fff7ed',100:'#ffedd5',200:'#fed7aa',300:'#fdba74',400:'#fb923c',500:'#f97316',600:'#ea580c',700:'#c2410c',800:'#9a3412',900:'#7c2d12'}},rose:{label:'Rose',primary:'#e11d48',secondary:'#ec4899',rgb:'225,29,72',palette:{50:'#fff1f2',100:'#ffe4e6',200:'#fecdd3',300:'#fda4af',400:'#fb7185',500:'#f43f5e',600:'#e11d48',700:'#be123c',800:'#9f1239',900:'#881337'}},midnight:{label:'Midnight',primary:'#1e293b',secondary:'#475569',rgb:'30,41,59',palette:{50:'#f8fafc',100:'#f1f5f9',200:'#e2e8f0',300:'#cbd5e1',400:'#94a3b8',500:'#64748b',600:'#475569',700:'#334155',800:'#1e293b',900:'#0f172a'}}};
        var savedTheme=localStorage.getItem('qm-theme')||'indigo';
        var T=THEMES[savedTheme]||THEMES.indigo;
        var ds=document.documentElement.style;
        Object.entries(T.palette).forEach(function(e){ds.setProperty('--t-'+e[0],e[1])});
        ds.setProperty('--t-primary',T.primary);ds.setProperty('--t-secondary',T.secondary);ds.setProperty('--t-rgb',T.rgb);
    </script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>tailwind.config={theme:{extend:{fontFamily:{sans:['Inter','sans-serif']},colors:{brand:T.palette,indigo:T.palette}}}}</script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/app.css">
</head>
<body class="bg-gray-50 min-h-screen flex flex-col">

<nav id="main-nav"></nav>

<div class="max-w-7xl mx-auto px-4 py-12" id="page-content">
    <!-- Header -->
    <div class="text-center mb-12">
        <h1 class="text-4xl md:text-5xl font-extrabold text-gray-800 mb-4">Choose Your Challenge</h1>
        <p class="text-lg text-gray-500 max-w-2xl mx-auto">Pick a quiz, test your knowledge, and climb the leaderboard!</p>
        <div class="flex flex-wrap justify-center gap-3 mt-8">
            <a href="create.html" class="inline-flex items-center gap-2 gradient-bg text-white px-5 py-2.5 rounded-lg font-semibold text-sm hover:opacity-90 transition">
                <i data-lucide="plus-circle" class="w-4 h-4"></i> Create Your Own
            </a>
            <a href="generate.html" class="inline-flex items-center gap-2 gradient-warm text-white px-5 py-2.5 rounded-lg font-semibold text-sm hover:opacity-90 transition">
                <i data-lucide="zap" class="w-4 h-4"></i> Instant Generate
            </a>
        </div>
    </div>

    <!-- Category Filter (generated by JS) -->
    <div class="flex flex-wrap justify-center gap-2 mb-10" id="category-filters"></div>

    <!-- Quiz Grid (generated by JS) -->
    <div id="quiz-grid"></div>
</div>

<footer id="main-footer"></footer>

<script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-database-compat.js"></script>
<script src="js/firebase-sync.js"></script>
<script src="js/question-bank.js"></script>
<script src="js/app.js"></script>
<script>
function pageInit() {
    const quizzes = DB.getQuizzes();
    const allAttempts = DB.getAttempts();

    // Category filter
    const categories = [...new Set(quizzes.map(q => q.category))].sort();
    const filterContainer = document.getElementById('category-filters');
    if (categories.length > 1) {
        let filterHtml = `<button onclick="filterCategory('all')" class="filter-btn active inline-flex items-center gap-1.5 px-4 py-2 rounded-full bg-indigo-600 text-white font-medium text-sm transition" data-category="all">
            <i data-lucide="layers" class="w-3.5 h-3.5"></i> All
        </button>`;
        categories.forEach(cat => {
            const icon = getCategoryIcon(cat);
            filterHtml += `<button onclick="filterCategory('${escapeHtml(cat)}')" class="filter-btn inline-flex items-center gap-1.5 px-4 py-2 rounded-full bg-gray-100 text-gray-600 font-medium text-sm transition hover:bg-gray-200" data-category="${escapeHtml(cat)}"><i data-lucide="${icon}" class="w-3.5 h-3.5"></i> ${escapeHtml(cat)}</button>`;
        });
        filterContainer.innerHTML = filterHtml;
    }

    // Quiz grid
    const grid = document.getElementById('quiz-grid');
    if (quizzes.length === 0) {
        grid.innerHTML = `<div class="text-center py-20">
            <div class="w-16 h-16 bg-gray-100 rounded-2xl flex items-center justify-center mx-auto mb-4">
                <i data-lucide="inbox" class="w-8 h-8 text-gray-400"></i>
            </div>
            <h2 class="text-2xl font-bold text-gray-600 mt-2">No quizzes yet!</h2>
            <p class="text-gray-400 mt-2">Quizzes will appear here once they're added.</p>
        </div>`;
    } else {
        grid.className = 'grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6';
        let html = '';
        quizzes.forEach(quiz => {
            const icon = getCategoryIcon(quiz.category);
            const diffColor = getDifficultyColor(quiz.difficulty);
            const qCount = (quiz.questions || []).length;
            const aCount = allAttempts.filter(a => a.quiz_id === quiz.id).length;
            html += `
            <div class="quiz-card card-hover bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden" data-category="${escapeHtml(quiz.category)}">
                <div class="gradient-bg p-5 text-white relative overflow-hidden">
                    <div class="absolute top-0 right-0 opacity-10 -mr-3 -mt-3">
                        <i data-lucide="${icon}" class="w-24 h-24"></i>
                    </div>
                    <div class="flex items-center gap-2 mb-2">
                        <div class="w-7 h-7 bg-white/20 rounded-md flex items-center justify-center">
                            <i data-lucide="${icon}" class="w-4 h-4"></i>
                        </div>
                        <span class="text-xs font-medium text-indigo-200">${escapeHtml(quiz.category)}</span>
                    </div>
                    <h3 class="text-lg font-bold leading-tight">${escapeHtml(quiz.title)}</h3>
                </div>
                <div class="p-5">
                    <p class="text-gray-500 text-sm mb-4 line-clamp-2">${escapeHtml(quiz.description)}</p>
                    <div class="flex items-center justify-between text-sm text-gray-400 mb-4">
                        <span class="inline-flex items-center gap-1">
                            <i data-lucide="file-text" class="w-3.5 h-3.5"></i> ${qCount} Questions
                        </span>
                        <span class="inline-flex items-center gap-1">
                            <i data-lucide="clock" class="w-3.5 h-3.5"></i> ${quiz.time_per_question}s each
                        </span>
                    </div>
                    <div class="flex items-center justify-between mb-5">
                        <span class="inline-flex items-center gap-1.5 text-sm font-medium">
                            <span class="w-2.5 h-2.5 rounded-full bg-${diffColor}-500"></span>
                            <span class="capitalize text-gray-600">${quiz.difficulty}</span>
                        </span>
                        <span class="inline-flex items-center gap-1 text-xs text-gray-400">
                            <i data-lucide="users" class="w-3 h-3"></i>
                            ${aCount} ${aCount === 1 ? 'attempt' : 'attempts'}
                        </span>
                    </div>
                    <a href="quiz.html?id=${quiz.id}" class="flex items-center justify-center gap-2 w-full gradient-bg text-white py-2.5 rounded-lg font-semibold text-sm hover:opacity-90 transition">
                        Start Quiz <i data-lucide="arrow-right" class="w-4 h-4"></i>
                    </a>
                </div>
            </div>`;
        });
        grid.innerHTML = html;
    }
    lucide.createIcons();
}

function filterCategory(category) {
    const cards = document.querySelectorAll('.quiz-card');
    const buttons = document.querySelectorAll('.filter-btn');
    buttons.forEach(btn => {
        btn.classList.remove('bg-indigo-600', 'text-white', 'active');
        btn.classList.add('bg-gray-100', 'text-gray-600');
    });
    const activeBtn = document.querySelector('[data-category="' + category + '"]');
    if (activeBtn) {
        activeBtn.classList.add('bg-indigo-600', 'text-white', 'active');
        activeBtn.classList.remove('bg-gray-100', 'text-gray-600');
    }
    cards.forEach(card => {
        if (category === 'all' || card.dataset.category === category) {
            card.style.display = '';
            card.classList.add('fade-in');
        } else {
            card.style.display = 'none';
        }
    });
}
</script>
</body>
</html>
